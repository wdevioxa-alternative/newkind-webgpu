var common=require("./common"),assert=require("assert"),events=require("../"),test=require("tape");function expect(e){var s=[];return test.onFinish((function(){var t=s.sort(),r=e.sort();assert.strictEqual(t.length,r.length);for(var n=0;n<t.length;n++){var o=t[n];assert.strictEqual(o,r[n])}})),common.mustCall((function(e){s.push(e)}),e.length)}var ee=new events.EventEmitter,noop=common.mustNotCall();ee.on("foo",noop),ee.on("bar",noop),ee.on("baz",noop),ee.on("baz",noop);var fooListeners=ee.listeners("foo"),barListeners=ee.listeners("bar"),bazListeners=ee.listeners("baz");ee.on("removeListener",expect(["bar","baz","baz"])),ee.removeAllListeners("bar"),ee.removeAllListeners("baz");var listeners=ee.listeners("foo");assert.ok(Array.isArray(listeners)),assert.strictEqual(listeners.length,1),assert.strictEqual(listeners[0],noop),listeners=ee.listeners("bar"),assert.ok(Array.isArray(listeners)),assert.strictEqual(listeners.length,0),listeners=ee.listeners("baz"),assert.ok(Array.isArray(listeners)),assert.strictEqual(listeners.length,0),assert.strictEqual(fooListeners.length,1),assert.strictEqual(fooListeners[0],noop),assert.strictEqual(barListeners.length,1),assert.strictEqual(barListeners[0],noop),assert.strictEqual(bazListeners.length,2),assert.strictEqual(bazListeners[0],noop),assert.strictEqual(bazListeners[1],noop),assert.notStrictEqual(ee.listeners("bar"),barListeners),assert.notStrictEqual(ee.listeners("baz"),bazListeners),(ee=new events.EventEmitter).on("foo",common.mustNotCall()),ee.on("bar",common.mustNotCall()),ee.on("removeListener",expect(["foo","bar","removeListener"])),ee.on("removeListener",expect(["foo","bar"])),ee.removeAllListeners(),listeners=ee.listeners("foo"),assert.ok(Array.isArray(listeners)),assert.strictEqual(listeners.length,0),listeners=ee.listeners("bar"),assert.ok(Array.isArray(listeners)),assert.strictEqual(listeners.length,0),(ee=new events.EventEmitter).on("removeListener",common.mustNotCall()),assert.doesNotThrow((function(){ee.removeAllListeners(ee,"foo")})),ee=new events.EventEmitter;var expectLength=2;ee.on("removeListener",(function(){assert.strictEqual(expectLength--,this.listeners("baz").length)})),ee.on("baz",common.mustNotCall()),ee.on("baz",common.mustNotCall()),ee.on("baz",common.mustNotCall()),assert.strictEqual(ee.listeners("baz").length,expectLength+1),ee.removeAllListeners("baz"),assert.strictEqual(ee.listeners("baz").length,0),ee=new events.EventEmitter,assert.strictEqual(ee,ee.removeAllListeners()),(ee=new events.EventEmitter)._events=void 0,assert.strictEqual(ee,ee.removeAllListeners());