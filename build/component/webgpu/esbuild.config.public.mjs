import esbuild from"esbuild";import cssModulesPlugin from"esbuild-css-modules-plugin";import{polyfillNode}from"esbuild-plugin-polyfill-node";import aliasPlugin from"esbuild-plugin-path-alias";import path from"path";import*as dotenv from"dotenv";import{copy}from"esbuild-plugin-copy";dotenv.config();const __dirname=path.join(path.dirname(process.argv[1]),"./");let define={};const buildPath="this",cyrb53=(e,o=0)=>{let i=3735928559^o,s=1103547991^o;for(let o,t=0;t<e.length;t++)o=e.charCodeAt(t),i=Math.imul(i^o,2654435761),s=Math.imul(s^o,1597334677);return i=Math.imul(i^i>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),4294967296*(2097151&s)+(i>>>0)};for(const e in process.env)(e.startsWith("REACT_APP_")||e.startsWith("PUBLIC_URL")||e.startsWith("PORT"))&&(define[`process.env.${e}`]=JSON.stringify(process.env[e]));const buildParams={entryPoints:["./main.mjs"],outfile:"../this/main.mjs",format:"esm",target:"es2022",loader:{".css":"copy",".data":"base64",".js":"jsx",".ttf":"base64",".json":"copy",".png":"file",".jpeg":"file",".jpg":"file",".svg":"dataurl",".woff":"file"},color:!0,minify:!0,bundle:!0,sourcemap:!0,mainFields:["module","main"],define:define,logLevel:"error",external:["*.gif"],plugins:[aliasPlugin({"@src":path.resolve(__dirname,"./")}),polyfillNode({process:!0,buffer:!0,define:define}),cssModulesPlugin({localsConvention:"dashes",inject:!0,generateScopedName:(e,o,i)=>{let s=path.dirname(o).split("/");return s=s[s.length-1],`${s}_${e}__${cyrb53(i,2)}`},generateTsFile:!0}),copy({resolveFrom:"cwd",assets:[{from:["./component/**/*.css","./component/**/*.wasm","./component/**/*.js","./component/index.html","./component/**/*.png"],to:["../this/component"]},{from:["./index.html"],to:["../this/index.html"]},{from:["./this/**"],to:["../this/this"]}],watch:!0})]};console.time("⚡ [esbuild] Done"),esbuild.build(buildParams).catch((e=>{console.error("ERROR ESBUILD",e),process.exit(1)})),console.timeEnd("⚡ [esbuild] Done");